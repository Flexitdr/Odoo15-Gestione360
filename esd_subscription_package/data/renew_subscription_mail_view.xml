<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Email Templates -->
    <record id="mail_template_esd_subscription_renew" model="mail.template">
        <field name="name">Subscription: Email Renew Alert</field>
        <field name="model_id" ref="esd_subscription_package.model_renew_subscription"/>
        <field name="subject">{{ object.company_id.name }} Please check the subscription </field>
        <field name="email_from">{{ object.company_id.email }}</field>
        <field name="email_to">{{ object.partner.email }}</field>
        <field name="auto_delete" eval="True"/>
        <field name="lang">{{ object.partner.lang }}</field>
        <field name="body_html" type="html">
            <div style="background:#F0F0F0;color:#515166;padding:20px 0px;font-family:Arial,Helvetica,sans-serif;font-size:14px;">
                <table style="width:600px;margin:5px auto;">
                    <tbody>
                        <tr>
                            <td>
                                <a href="/">
                                    <img src="/web/binary/company_logo"
                                         style="vertical-align:baseline;max-width:100px;"/>
                                </a>
                            </td>
                            <td style="text-align:right;vertical-align:middle;">
                                Subscription Renew Alert
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table style="width:600px;margin:0px auto;background:white;border:1px solid #e1e1e1;">
                    <tbody>
                        <tr>
                            <td style="padding:15px 20px 10px 20px;">
                                <div class="row">
                                    <div class="col-md-6">
                                        <p><b>Dear <t t-out="object.partner.name or ''"/></b>,
                                        </p>
                                    </div>
                                    <div class="col-md-6" style="text-align:right; background-color:#d6d6d6;">

                                        <p><t t-out="object.partner.city or ''"/></p>
                                        <p><t t-out="object.partner.street or ''"/></p>
                                        <p><t t-out="object.partner.street2 or ''"/></p>
                                        <p><t t-out="object.partner.phone or ''"/></p>

                                    </div>
                                </div>

                                <p>Your subscription expires in two months, make the payment to continue with the maintenance service</p>
                                <hr/>

                                <t t-set="total" t-value="0"/>

                                <t t-foreach="object.subscriptions" t-as="subs">
                                    <h2 style="background-color:gray;"><b>Subscriptions: <t t-out="subs.name"/></b></h2>

                                    <t t-foreach="subs.product_line_ids.product_id" t-as="prod">
                                        <p><b>Products:</b> <t t-out="prod.name"/>, <b>Price</b>:<t t-out="prod.list_price"/></p>
                                    </t>

                                    <p> <b>Subscription debt:</b> <t t-out="subs.total_recurring_price"/>
                                         <t t-set="total" t-value="total + subs.total_recurring_price"/>
                                    </p>
                                </t>

                                <hr/>
                                <p>TOTAL TO PAY: <t t-esc="total"/></p>
                            </td>
                        </tr>
                        <tr>
                        </tr>
                    </tbody>
                </table>
            </div>
        </field>
    </record>

</odoo>